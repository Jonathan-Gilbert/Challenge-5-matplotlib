Code partially taken from https://github.com/benanza/Pymaceuticals